Довольно часто нам нужно рисовать растровые изображения в повернутом или иным образом измененном состоянии. Можно использовать Photoshop или любое другое ПО для редактирования изображений, и создать больше картинок из исходной.

Затем, когда на необходимо отрисовать наше растровое изображение, мы можем просто решить, в какую сторону и нарисовать соответствующее предварительно загруженное растровое изображение.

Но гораздо интереснее и поучительнее будет, если мы будем работать только с одним исходным изображением и узнаем о классе, который Android предоставляет для манипулирования изображениями в Java-коде. Затем вы сможете добавить вращающуюся и инвертирующую графику в инструментарий разработчика вашего приложения.

## Что такое растровое изображение (Bitmap)?
Bitmap он называется неспроста, потому что именно так оно и есть. Карта битов. Несмотря на то, что существует множество растровых форматов, использующих различные диапазоны и значения для представления цветов и прозрачности, все они сводятся к одному и тому же. Они представляют собой сетку / карту значений, и каждое значение представляет собой цвет одного пикселя.

Поэтому, чтобы повернуть, масштабировать или инвертировать растровое изображение, мы должны выполнить соответствующие математические вычисления для каждого пикселя/бита карты растрового изображения. Расчеты не слишком сложны, но и не особенно просты. Если вы освоили математику средней школы, вы, вероятно, поймете без особых хлопот.

К сожалению, понимания математики недостаточно. Нам также нужно будет разработать эффективный код, а также понять формат растрового изображения, а затем изменить наш код для каждого формата. Это было бы совсем не тривиально. К счастью, Android API сделал все это за нас. Познакомьтесь с классом **Matrix**.

## Класс Matrix
Класс называется матрицей, потому что он использует математическую концепцию и правила для выполнения вычислений по ряду значений, известных как матрицы.

> Класс Android **Matrix** не имеет ничего общего с одноименному фильму. Однако советую всем начинающим разработчикам приложений принимать красную таблетку :)

Возможно, вы знакомы с матрицами, но не волнуйтесь, если это не так, потому что класс **Matrix** скрывает всю сложность. Кроме того, этот класс не только позволяет нам выполнять вычисления по ряду значений, но также имеет некоторые заранее подготовленные вычисления, которые позволяют нам делать такие вещи, как поворот точки вокруг другой точки на определенное число градусов. И все это без всякого знания тригонометрии.

### Переворот изображения в противоположную сторону
Во-первых, нам нужно создать экземпляр класса Matrix.
```java
Matrix matrix = new Matrix();
```
> Обратите внимание, что вам не нужно добавлять этот код в проект прямо сейчас. Скоро все будет с гораздо большим контекстом.

Теперь мы можем использовать один из многих аккуратных методов класса **Matrix**. Метод **preScale** принимает два параметра: один для горизонтального изменения, а другой для вертикального изменения. Посмотрите на эту строку кода:
```java
matrix.preScale(-1, 1);
```
То, что делает метод **preScale** - это перебирает каждую позицию пикселя и умножает все горизонтальные координаты на -1 и все вертикальные координаты на 1.

Результат этих вычислений заключается в том, что все вертикальные координаты останутся неизменными, потому что если вы умножите их на единицу, то число не изменится. Однако при умножении на минус единицу горизонтальное положение пикселя будет перевернуто. Например, горизонтальные позиции 0, 1, 2, 3 и 4 станут 0, -1, -2, -3 и -4.

На этом этапе мы создали матрицу, которая может выполнять необходимые вычисления на растровом изображении. Но мы еще ничего не сделали с растровым изображением. Чтобы использовать матрицу, мы вызываем метод **createBitmap** класса **Bitmap**, как в этой строке кода:
```java
Bitmap bitmapLeft = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth() - 1, bitmap.getHeight() - 1, matrix, true);
```
Аргументы метода **createBitmap**:
- bitmap - это растровый объект, который уже был создан, и в него загружено изображение. Это изображение будет использоваться в качестве источника для создания нового растрового изображения. Исходное растровое изображение фактически не будет изменено вообще.
- 0, 0 - это начальная горизонтальная и вертикальная позиция, координаты точки, от которой будем отсчитывать часть.
- аргументы ```bitmap.getWidth() - 1, bitmap.getHeight() - 1``` - это значения, ширины и высоты от начальной позиции.
- Следующий аргумент - это наш заранее подготовленный экземпляр матрицы, ```matrix```.
- Последний аргумент - filter, если true, то будет включено сглаживание при scale- и rotate-преобразованиях матрицы.

### Поворот растрового изображения
Давайте посмотрим на вращение растрового изображения, а затем мы сможем построить демонстрационное приложение. У нас уже есть экземпляр класса Matrix, поэтому все, что нам нужно сделать, это вызвать метод **preRotate**, чтобы создать матрицу, способную поворачивать каждый пиксель на заданное число градусов.
```java
matrix.preRotate(-90);
```
Насколько это было просто? Экземпляр матрицы теперь готов повернуть любую серию чисел, которую мы передадим ему, против часовой стрелки ( - ), на 90 градусов.

Cледующая строка кода имеет точно такие же аргументы, как и предыдущий вызов **createBitmap**, за исключением того, что новое растровое изображение присваивается bitmapUp, и эффект Матрицы заключается в выполнении поворота вместо **preScale**:
```java
Bitmap bitmapUp = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth() - 1, bitmap.getHeight() - 1, matrix, true);
```

Вы можете использовать такую же технику, чтобы развернуть растровое изображение вниз. Давайте перейдем к демонстрационному приложению, чтобы увидеть все это в действии.
